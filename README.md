# logistic-model-fitting
**Python** package for fitting logistic functions to data

Have you ever wanted to fit a flexible logistic function to your data??? If so, this might be useful...

This tool fits a logistic function to a series of data points **AND** provides information about the goodness of your model fit (based on permutation testing). The logistic function takes the form:

![Logistic-Function](https://user-images.githubusercontent.com/6549946/124682643-d2643d00-deba-11eb-9007-1b2b19d3ad42.jpeg)
(image from https://andymath.com/logistic-function/)

## Usage:

```
from log_fit import main_log_fit
results = main_log_fit(x, y) # Runs without any permutation testing - fast (by default)
results = main_log_fit(x, y, to_perm_test=True, Nsim=1000) # Run with permutation testing to determine whether fit is significant, N=1000 null simulations
```

## Output:

Parameters:<br />
```results.x            ``` inflection point (value of x where maximum change in y occurs; x0 in function above)<br />
```results.k            ``` slope (k in above formula, 'growth rate')<br />
```results.y_init       ``` y-value at x=0<br />
```results.y_final     ``` y-value at asymptote (L in above formula)<br />
```results.y_change    ``` total change in y (y_final minus y_init)<br />

Goodness of fit information:<br />
```results.stats_r     ``` *Spearman Rank correlation* between actual y and predicted y values (goodness of fit metric)<br />
```results.stats_Ppara  ``` P-value from Rank correlation between actual y and predicted y values (i.e. parametric)<br />
```results.stats_Pperm  ``` P-value of goodness of fit based on permutation testing<br />

## Example usage
***See the Jupyter notebook in this repo for examples. Some snippets are below!***

First, imports. The function *main_log_fit* is imported from log_fit.py 
![image](https://user-images.githubusercontent.com/6549946/124685392-0cffb280-de86-11eb-9166-320375c7b418.png)

Next, some data to work with: 
![image](https://user-images.githubusercontent.com/6549946/124685326-e5104f00-de85-11eb-80b0-149ac4bf5e0c.png)

Here is what it looks like (note, this is real data from a behavioral learning experiment!): 
![image](https://user-images.githubusercontent.com/6549946/124685508-40dad800-de86-11eb-9ad6-2c7153c573b4.png)

Now, use model_log_fit to actually fit functions to the data (y1, y2):![image](https://user-images.githubusercontent.com/6549946/124695912-fa42a900-de98-11eb-8b55-67269d009d64.png)

As shown in the first two lines above, the function can be run by just fitting a model to the data (without performing any permutation testing). By default, no permutation testing is performed.

**OR (last two lines)**, it can be run with permutation testing, which assesses the statistical significance of a model fit occuring by chance. Specifically, a null distribution of the model fit is generated by randomly permuting the values in X and computing the model fit based on permuted-X and Y values. The true model fit is then compared to the null distribution of models fit to produce a P-value (probability that a model fit of similar or higher value is observed by chance).

Here are the resulting model fits: 
![image](https://user-images.githubusercontent.com/6549946/124686123-62888f00-de87-11eb-9d81-17d17dccc2cf.png)

And the ***actual numbers*** that are of interest... 
![image](https://user-images.githubusercontent.com/6549946/124686179-7cc26d00-de87-11eb-8b07-5e1cdec2aa70.png)

All outputs of interest are in the *results* object, which are described above 
